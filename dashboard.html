<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>NEXORA Digital - Dashboard</title>
  <link rel="stylesheet" href="css/style.css">
</head>
<body>
  <header>
    <h1>NEXORA Digital Dashboard</h1>
    <p>The owner: Mohamed Amr</p>
  </header>

  <!-- Wallet Ø§Ù„Ø¹Ù…ÙŠÙ„ -->
  <section class="wallet-section">
    <h2>Your Wallet</h2>
    <p>Balance: $<span id="wallet_balance">0</span></p>
  </section>

  <!-- Wallet Ø§Ù„Ù…Ø§Ù„Ùƒ -->
  <section class="wallet-section">
    <h2>Owner Wallet</h2>
    <p>Balance: $<span id="owner_wallet">0</span></p>
  </section>

  <!-- Ø¥Ù†Ø´Ø§Ø¡ Ø£ÙˆØ±Ø¯Ø± -->
  <section class="order-section">
    <h2>Create New Order</h2>
    <input type="text" id="project_name" placeholder="Project Name">
    <input type="text" id="description" placeholder="Description">
    <input type="text" id="category" placeholder="Category">
    <input type="number" id="price" placeholder="Price">
    <button onclick="createOrder()">Submit Order</button>
  </section>

  <!-- Ø¹Ø±Ø¶ Ø§Ù„Ø£ÙˆØ±Ø¯Ø±Ø§Øª -->
  <section class="orders-list">
    <h2>Your Orders</h2>
    <ul id="order_list"></ul>
  </section>

  <!-- Ø³ÙƒØ±Ø¨Øª Ø§Ù„ØªØ´ØºÙŠÙ„ -->
  <script src="js/orders.js"></script>
  <script>
    // =======================
    // Helper Functions
    // =======================
    function getOrders() {
      return JSON.parse(localStorage.getItem('orders') || '[]')
    }

    function saveOrders(orders) {
      localStorage.setItem('orders', JSON.stringify(orders))
    }

    function getWallet() {
      return Number(localStorage.getItem('wallet_balance') || 0)
    }

    function setWallet(amount) {
      localStorage.setItem('wallet_balance', amount)
      document.getElementById('wallet_balance').textContent = amount
    }

    function getOwnerWallet() {
      return Number(localStorage.getItem('owner_wallet_balance') || 0)
    }

    function setOwnerWallet(amount) {
      localStorage.setItem('owner_wallet_balance', amount)
      document.getElementById('owner_wallet').textContent = amount
    }

    // =======================
    // Bots Functions
    // =======================
    function designBot(order) {
      console.log(`ðŸ¤– Bot: Creating design for "${order.project_name}" in category "${order.category}"...`)
      setTimeout(() => {
        console.log(`âœ… Design ready for "${order.project_name}"!`)
        order.designLink = `https://example.com/designs/${order.id}`
        saveOrders(getOrders())
        displayOrders()
      }, 5000)
    }

    function websiteBot(order) {
      console.log(`ðŸ¤– Bot: Building website for "${order.project_name}"...`)
      setTimeout(() => {
        console.log(`âœ… Website ready for "${order.project_name}"!`)
        order.websiteLink = `https://example.com/websites/${order.id}`
        order.status = 'completed'
        saveOrders(getOrders())
        displayOrders()
      }, 8000)
    }

    // =======================
    // Create Order
    // =======================
    function createOrder() {
      const user_id = localStorage.getItem('user_id') || 'demo_user'
      const project_name = document.getElementById('project_name').value
      const description = document.getElementById('description').value
      const category = document.getElementById('category').value
      const price = Number(document.getElementById('price').value) || 0

      if(!project_name || !description || !category || price <= 0){
        alert('Please fill all fields with valid values!')
        return
      }

      const orders = getOrders()
      const order = {
        id: Date.now(),
        user_id,
        project_name,
        description,
        category,
        price,
        status: 'pending'
      }

      orders.unshift(order)
      saveOrders(orders)

      // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…Ø­ÙØ¸Ø© Ø§Ù„Ø¹Ù…ÙŠÙ„
      let wallet = getWallet()
      wallet += price
      setWallet(wallet)

      // ØªØ­Ø¯ÙŠØ« Ù…Ø­ÙØ¸Ø© Ø§Ù„Ù…Ø§Ù„Ùƒ
      let ownerWallet = getOwnerWallet()
      ownerWallet += price
      setOwnerWallet(ownerWallet)

      alert('Order submitted! Wallet updated + Bot is processing...')
      displayOrders()

      // ØªØ´ØºÙŠÙ„ Ø§Ù„Ø¨ÙˆØªØ§Øª
      designBot(order)
      websiteBot(order)
    }

    // =======================
    // Display Orders
    // =======================
    function displayOrders() {
      const user_id = localStorage.getItem('user_id') || 'demo_user'
      const orders = getOrders().filter(o => o.user_id === user_id)
      const ul = document.getElementById('order_list')
      ul.innerHTML = ''
      orders.forEach(o => {
        const li = document.createElement('li')
        li.textContent = `${o.project_name} - ${o.category} - $${o.price} - ${o.status}`
        if(o.designLink) li.innerHTML += ` - <a href="${o.designLink}" target="_blank">Design</a>`
        if(o.websiteLink) li.innerHTML += ` - <a href="${o.websiteLink}" target="_blank">Website</a>`
        ul.appendChild(li)
      })
    }

    // =======================
    // Initialize
    // =======================
    displayOrders()
    setWallet(getWallet())
    setOwnerWallet(getOwnerWallet())

    // Make global
    window.createOrder = createOrder
    window.displayOrders = displayOrders
  </script>
</body>
</html>
